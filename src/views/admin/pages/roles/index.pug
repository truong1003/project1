extends ../../layout/defaut.pug
include ../../mixins/form-search.pug


block main 

    if(role.permission.includes("roles_view"))          

        h1 Nhóm quyền

        .card.mb-3 
            .card-header Bộ lọc và Tìm kiếm 
            .card-body
                .row 
                    .col-6 
                        a(
                            href=`${prefixAdmin}/roles/trash` 
                            class="btn btn-sm ml-1 btn-outline-success"
                        ) Trash
        
                    .col-6 
                        +form-search(keyword)


        .card.mb-3 
            .card-header Bộ lọc và Tìm kiếm 
            .card-body
                .row 
                    .col-8
                    .col-4.text-right 
                        if(role.permission.includes("roles_create"))          
                            a(
                                href=`${prefixAdmin}/roles/create` 
                                class="btn btn-outline-success"
                            ) + Thêm mới
        
            table(
                class="table table-hover table-sm"
            )
                thead 
                    tr  
                        th STT 
                        th Nhóm quyền
                        th Mô tả ngắn 
                        th Người tạo
                        th Người cập nhật
                        th Hành động

                tbody 
                    if(records.length>0)
                        each item,index in records
                            tr
                                td #{index + 1}
                                td #{item.title}
                                td #{item.description}
                                td 
                                    p #{item.fullName}
                                    p #{moment(item.createdBy.createdAt).format("DD/MM/YYYY")} 
                                td 
                                    p #{item.fullNameUpdate}
                                    p #{moment(item.updatedBy.updatedAt).format("DD/MM/YYYY")} 

                                td 
                                    a(
                                        class="btn btn-secondary btn-sm"
                                        href=`${prefixAdmin}/roles/detail/${item.id}`
                                    ) Chi tiết
                                    if(role.permission.includes("roles_edit"))          
                                        a(
                                            class="btn btn-warning btn-sm ml-1"
                                            href=`${prefixAdmin}/roles/edit/${item.id}`
                                        ) Sửa
                                    if(role.permission.includes("roles_delete"))                                              
                                        a(
                                            class="btn btn-danger btn-sm ml-1"
                                            data-id=item.id
                                            button-delete
                                        ) Xóa
                    else 
                        tr
                            td(colspan="4" class="text-center") Chưa có
    
        form(action="" 
                method="POST"
                id="form-delete-role"
                data-path=`${prefixAdmin}/roles/deleted`
            )
        
        script(src="/admin/js/roles.js")            
